SELECT  DR.DEP_ID, D.DEP_NAME, DEP_PHONE, DEP_REASON, DR.EMP_NO, E.EMP_NAME, DR.DEP_RECORD_DATE,
J.JOB_NAME, P.POSITION_NAME
FROM DEPT_RECORD DR
JOIN DEPARTMENT D ON(D.DEP_ID = DR.DEP_ID)
JOIN EMPLOYEE E ON(E.EMP_NO = DR.EMP_NO)
JOIN JOB_RECORD JR ON(JR.EMP_NO = E.EMP_NO)
JOIN JOB J ON(J.JOB_CODE = JR.JOB_CODE)
JOIN POSITION_RECORD PR ON(PR.EMP_NO = E.EMP_NO)
JOIN POSITION P ON(P.POSITION_NO = PR.POSITION_NO)
WHERE  DEP_RECORD_DATE = (SELECT MAX(DEP_RECORD_DATE) FROM DEPT_RECORD R WHERE R.EMP_NO = E.EMP_NO)
AND JOB_RECORD_DATE = (SELECT MAX(JOB_RECORD_DATE) FROM JOB_RECORD R WHERE R.EMP_NO = E.EMP_NO)
AND POSITION_RECORD_DATE = (SELECT MAX(POSITION_RECORD_DATE) FROM POSITION_RECORD R WHERE R.EMP_NO = E.EMP_NO)
AND DEP_NAME = '회계부'
AND NOT DEP_REASON = '입사'
AND TO_CHAR(DEP_RECORD_DATE, 'MM') = '10'
ORDER BY DEP_RECORD_DATE DESC;



SELECT  DR.DEP_ID, D.DEP_NAME, DEP_PHONE, DEP_REASON, DR.EMP_NO, E.EMP_NAME, DR.DEP_RECORD_DATE,
J.JOB_NAME, P.POSITION_NAME
FROM DEPT_RECORD DR
JOIN DEPARTMENT D ON(D.DEP_ID = DR.DEP_ID)
JOIN EMPLOYEE E ON(E.EMP_NO = DR.EMP_NO)
JOIN JOB_RECORD JR ON(JR.EMP_NO = E.EMP_NO)
JOIN JOB J ON(J.JOB_CODE = JR.JOB_CODE)
JOIN POSITION_RECORD PR ON(PR.EMP_NO = E.EMP_NO)
JOIN POSITION P ON(P.POSITION_NO = PR.POSITION_NO)
WHERE  DEP_RECORD_DATE = (SELECT MAX(DEP_RECORD_DATE) FROM DEPT_RECORD R WHERE R.EMP_NO = E.EMP_NO)
AND JOB_RECORD_DATE = (SELECT MAX(JOB_RECORD_DATE) FROM JOB_RECORD R WHERE R.EMP_NO = E.EMP_NO)
AND POSITION_RECORD_DATE = (SELECT MAX(POSITION_RECORD_DATE) FROM POSITION_RECORD R WHERE R.EMP_NO = E.EMP_NO)
AND NOT DEP_REASON = '입사'
ORDER BY DEP_RECORD_DATE DESC;


SELECT D.DEP_NAME, DR.EMP_NO, E.EMP_NAME,
J.JOB_NAME,E.HIRE_DATE, E.LEAVE_DATE
FROM DEPT_RECORD DR
JOIN DEPARTMENT D ON(D.DEP_ID = DR.DEP_ID)
JOIN EMPLOYEE E ON(E.EMP_NO = DR.EMP_NO)
JOIN JOB_RECORD JR ON(JR.EMP_NO = E.EMP_NO)
JOIN JOB J ON(J.JOB_CODE = JR.JOB_CODE)
JOIN POSITION_RECORD PR ON(PR.EMP_NO = E.EMP_NO)
JOIN POSITION P ON(P.POSITION_NO = PR.POSITION_NO)
WHERE  DEP_RECORD_DATE = (SELECT MAX(DEP_RECORD_DATE) FROM DEPT_RECORD R WHERE R.EMP_NO = E.EMP_NO)
AND JOB_RECORD_DATE = (SELECT MAX(JOB_RECORD_DATE) FROM JOB_RECORD R WHERE R.EMP_NO = E.EMP_NO)
AND POSITION_RECORD_DATE = (SELECT MAX(POSITION_RECORD_DATE) FROM POSITION_RECORD R WHERE R.EMP_NO = E.EMP_NO)
AND E.STATUS = 'N'
AND DEP_NAME = '인사부';


SELECT EMP_NAME, EMP_NO
FROM EMPLOYEE
WHERE STATUS = 'N';



SELECT D.DEP_NAME, DR.EMP_NO, E.EMP_NAME,
		J.JOB_NAME,TO_CHAR(DR.DEP_RECORD_DATE,'YYYY-MM-DD')DEP_RECORD_DATE,
        DR.DEP_REASON
		FROM DEPT_RECORD DR
		JOIN DEPARTMENT D ON(D.DEP_ID = DR.DEP_ID)
		JOIN EMPLOYEE
		E ON(E.EMP_NO = DR.EMP_NO)
		JOIN JOB_RECORD JR ON(JR.EMP_NO = E.EMP_NO)
		JOIN JOB J ON(J.JOB_CODE = JR.JOB_CODE)
		JOIN POSITION_RECORD PR
		ON(PR.EMP_NO = E.EMP_NO)
		JOIN POSITION P ON(P.POSITION_NO =
		PR.POSITION_NO)     
		WHERE DEP_RECORD_DATE = (SELECT MAX(DEP_RECORD_DATE)
		FROM DEPT_RECORD R
		WHERE R.EMP_NO = E.EMP_NO)
		AND JOB_RECORD_DATE =
		(SELECT MAX(JOB_RECORD_DATE) FROM JOB_RECORD R
		WHERE R.EMP_NO =
		E.EMP_NO)
		AND POSITION_RECORD_DATE = (SELECT MAX(POSITION_RECORD_DATE)
		FROM
		POSITION_RECORD R WHERE R.EMP_NO = E.EMP_NO)
		AND E.STATUS = 'Y'
        ORDER BY DR.DEP_RECORD_DATE;
        
       -- 사원별 부서이동 이력    
        SELECT D.DEP_NAME, DR.EMP_NO, E.EMP_NAME,
		J.JOB_NAME,TO_CHAR(DR.DEP_RECORD_DATE,'YYYY-MM-DD')DEP_RECORD_DATE,
        DR.DEP_REASON
		FROM DEPT_RECORD DR
		JOIN DEPARTMENT D ON(D.DEP_ID = DR.DEP_ID)
		JOIN EMPLOYEE
		E ON(E.EMP_NO = DR.EMP_NO)
		JOIN JOB_RECORD JR ON(JR.EMP_NO = E.EMP_NO)
		JOIN JOB J ON(J.JOB_CODE = JR.JOB_CODE)
		JOIN POSITION_RECORD PR
		ON(PR.EMP_NO = E.EMP_NO)
		JOIN POSITION P ON(P.POSITION_NO =
		PR.POSITION_NO)     
		AND JOB_RECORD_DATE =
		(SELECT MAX(JOB_RECORD_DATE) FROM JOB_RECORD R
		WHERE R.EMP_NO =
		E.EMP_NO)
		AND POSITION_RECORD_DATE = (SELECT MAX(POSITION_RECORD_DATE)
		FROM
		POSITION_RECORD R WHERE R.EMP_NO = E.EMP_NO)
		AND E.STATUS = 'Y'
        AND E.EMP_NO = 1000
        ORDER BY DR.DEP_RECORD_DATE;
        
        SELECT *
        FROM DEPT_RECORD
        WHERE EMP_NO = 1000;
       
